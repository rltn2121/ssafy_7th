import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;

public class SimpleDao {
	public int insert(SimpleDto dto) throws SQLException {
		int ret = -1;
		String sql = "insert into jdbc_table (col_nm, col_not_null, col_default_val) values (?, ?, ?)";
		Connection con = DBManager.getConnection();
		
		PreparedStatement pstmt = con.prepareStatement(sql);
		pstmt.setString(1, dto.getColNm());
		pstmt.setString(2, dto.getColNotNull());
		pstmt.setString(3, dto.getColDefaultVal());
		
		ret = pstmt.executeUpdate();
		DBManager.releaseConnection(pstmt, con);
		return ret;
	}
	
	public int insertWithoutDefaultValue(SimpleDto dto) throws SQLException {
		int ret = -1;
		String sql = "insert into jdbc_table (col_nm, col_not_null) values (?, ?)";
		Connection con = DBManager.getConnection();
		
		PreparedStatement pstmt = con.prepareStatement(sql);
		pstmt.setString(1, dto.getColNm());
		pstmt.setString(2, dto.getColNotNull());
//		pstmt.setString(3, dto.getColDefaultVal());
		
		ret = pstmt.executeUpdate();
		DBManager.releaseConnection(pstmt, con);
		return ret;
	}
	
	
	public int insertDup(SimpleDto dto) throws SQLException {
		int ret = -1;
		String sql = "insert into jdbc_table (col_id, col_nm, col_not_null, col_default_val) values (?, ?, ?, ?)";
		Connection con = DBManager.getConnection();
		
		PreparedStatement pstmt = con.prepareStatement(sql);
		pstmt.setInt(1, dto.getColId());
		pstmt.setString(2, dto.getColNm());
		pstmt.setString(3, dto.getColNotNull());
		pstmt.setString(4, dto.getColDefaultVal());
		
		ret = pstmt.executeUpdate();
		DBManager.releaseConnection(pstmt, con);
		return ret;
	}
	
	
	public int insert2(SimpleDto dto) throws SQLException {
		int ret = -1;
//		String sql = "insert into jdbc_table (col_nm, col_not_null, col_default_val) values (?, ?, ?)";
		StringBuilder sql = new StringBuilder();
		sql.append("insert into jdbc_table (col_nm, col_not_null, col_default_val) values ('")
		.append(dto.getColNm()).append("', '")
		.append(dto.getColNotNull()).append("', '")
		.append(dto.getColDefaultVal()).append("')");
		
		Connection con = DBManager.getConnection();
		
		Statement stmt = con.createStatement();
		
		ret = stmt.executeUpdate(sql.toString());
		DBManager.releaseConnection(stmt, con);
		return ret;
	}
}

